<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">

    <!-- Caractéristiques physiques (communes à tous les types de brouillons) -->
    <div class="users-form-group users-form-group-full periode-group candidats-mt-20">
        <!-- Titre -->
        <b>
            <p:outputLabel value="Caractéristiques physiques"
                           styleClass="caracteristiques-physiques-title candidats-label-pl"/>
        </b>

        <!-- Métrologie -->
        <h:panelGroup styleClass="users-form-group users-form-group-full">
            <div class="periode-header-row">
                <p:outputLabel value="Métrologie" />
            </div>
            <div class="periode-field-row periode-autocomplete-row candidat-production-wrapper candidat-production-group">
                <div id="metrologieAutocompleteWrapper" class="input-wrapper periode-input-wrapper candidats-input-wrapper-border periode-autocomplete-wrapper candidat-production-input-wrapper">
                    <i class="pi pi-arrows-h input-icon periode-autocomplete-icon" />
                    <p:autoComplete id="metrologieAutocomplete"
                                   value="#{candidatBean.metrologieAutocompleteSelection}"
                                   completeMethod="#{openThesoDialogBean.completeMetrologie}"
                                   converter="pactolsConceptConverter"
                                   var="concept"
                                   itemLabel="#{concept.selectedTerm}"
                                   itemValue="#{concept}"
                                   dropdown="false"
                                   minQueryLength="2"
                                   appendTo="#metrologieAutocompleteWrapper"
                                   my="left top"
                                   at="left bottom"
                                   panelStyleClass="periode-autocomplete-panel"
                                   scrollHeight="280"
                                   emptyMessage="#{openThesoDialogBean.getEmptyMessageFor('METROLOGIE')}"
                                   placeholder="Ex. Dimensions, poids..."
                                   styleClass="users-input periode-autocomplete-input"
                                   forceSelection="false"
                                   rendered="#{candidatBean.canEditCurrentBrouillon()}"/>
                    <p:inputText value="#{candidatBean.metrologie != null ? candidatBean.metrologie.valeur : ''}"
                                 styleClass="users-input"
                                 readonly="true"
                                 placeholder="Aucune métrologie sélectionnée"
                                 rendered="#{candidatBean.isCurrentBrouillonReadOnly()}"/>
                </div>
                <div class="periode-action-buttons">
                    <p:commandButton icon="pi pi-check"
                                     styleClass="candidat-btn-save periode-save-btn"
                                     title="Enregistrer la métrologie"
                                     rendered="#{candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.saveMetrologieFromAutocomplete}"
                                     process="@form"
                                     ajax="true"
                                     update="@form :growl"/>
                    <p:commandButton icon="pi pi-trash"
                                     styleClass="candidat-btn-remove"
                                     title="Supprimer la métrologie"
                                     rendered="#{candidatBean.hasMetrologie() and candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.prepareConfirmDeleteMetrologie()}"
                                     process="@this"
                                     update="@none"
                                     oncomplete="PF('confirmDeleteReferenceDialog').show();"/>
                </div>
            </div>
            <p:message for="@previous" display="icon"/>
        </h:panelGroup>

        <!-- Fabrication/façonnage -->
        <h:panelGroup styleClass="users-form-group users-form-group-full candidats-mt-10">
            <div class="periode-header-row">
                <p:outputLabel value="Fabrication/façonnage" />
            </div>
            <div class="periode-field-row periode-autocomplete-row candidat-production-wrapper candidat-production-group">
                <div id="fabricationFaconnageAutocompleteWrapper" class="input-wrapper periode-input-wrapper candidats-input-wrapper-border periode-autocomplete-wrapper candidat-production-input-wrapper">
                    <i class="pi pi-wrench input-icon periode-autocomplete-icon" />
                    <p:autoComplete id="fabricationFaconnageAutocomplete"
                                   value="#{candidatBean.fabricationFaconnageAutocompleteSelection}"
                                   completeMethod="#{openThesoDialogBean.completeFabricationFaconnage}"
                                   converter="pactolsConceptConverter"
                                   var="concept"
                                   itemLabel="#{concept.selectedTerm}"
                                   itemValue="#{concept}"
                                   dropdown="false"
                                   minQueryLength="2"
                                   appendTo="#fabricationFaconnageAutocompleteWrapper"
                                   my="left top"
                                   at="left bottom"
                                   panelStyleClass="periode-autocomplete-panel"
                                   scrollHeight="280"
                                   emptyMessage="#{openThesoDialogBean.getEmptyMessageFor('FABRICATION_FACONNAGE')}"
                                   placeholder="Ex. Tournage, Moulage..."
                                   styleClass="users-input periode-autocomplete-input"
                                   forceSelection="false"
                                   rendered="#{candidatBean.canEditCurrentBrouillon()}"/>
                    <p:inputText value="#{candidatBean.fabricationFaconnage != null ? candidatBean.fabricationFaconnage.valeur : ''}"
                                 styleClass="users-input"
                                 readonly="true"
                                 placeholder="Aucune fabrication/façonnage sélectionnée"
                                 rendered="#{candidatBean.isCurrentBrouillonReadOnly()}"/>
                </div>
                <div class="periode-action-buttons">
                    <p:commandButton icon="pi pi-check"
                                     styleClass="candidat-btn-save periode-save-btn"
                                     title="Enregistrer la fabrication/façonnage"
                                     rendered="#{candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.saveFabricationFaconnageFromAutocomplete}"
                                     process="@form"
                                     ajax="true"
                                     update="@form :growl"/>
                    <p:commandButton icon="pi pi-trash"
                                     styleClass="candidat-btn-remove"
                                     title="Supprimer la fabrication/façonnage"
                                     rendered="#{candidatBean.hasFabricationFaconnage() and candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.prepareConfirmDeleteFabricationFaconnage()}"
                                     process="@this"
                                     update="@none"
                                     oncomplete="PF('confirmDeleteReferenceDialog').show();"/>
                </div>
            </div>
            <p:message for="@previous" display="icon"/>
        </h:panelGroup>

        <!-- Description pâte (champ texte, valeur simple) -->
        <div class="users-form-group users-form-group-full candidats-mt-10">
            <p:outputLabel value="Description pâte" />
            <div class="input-wrapper periode-input-wrapper candidats-input-wrapper-border">
                <i class="pi pi-align-left input-icon" />
                <p:inputText value="#{candidatBean.descriptionPate}"
                             rendered="#{candidatBean.canEditCurrentBrouillon()}"
                             styleClass="users-input"
                             placeholder="Saisissez la description de la pâte..."
                             maxlength="255">
                    <p:ajax event="blur" listener="#{candidatBean.saveDescriptionPate}" process="@this" update="@none"/>
                </p:inputText>
                <p:inputText value="#{candidatBean.descriptionPate}"
                             styleClass="users-input"
                             readonly="true"
                             placeholder="Non renseigné"
                             rendered="#{candidatBean.isCurrentBrouillonReadOnly()}"/>
            </div>
            <p:message for="@previous" display="icon"/>
        </div>

        <!-- Couleur de pâte -->
        <h:panelGroup styleClass="users-form-group users-form-group-full candidats-mt-10">
            <div class="periode-header-row">
                <p:outputLabel value="Couleur de pâte" />
            </div>
            <div class="periode-field-row periode-autocomplete-row candidat-production-wrapper candidat-production-group">
                <div id="couleurPateAutocompleteWrapper" class="input-wrapper periode-input-wrapper candidats-input-wrapper-border periode-autocomplete-wrapper candidat-production-input-wrapper">
                    <i class="pi pi-palette input-icon periode-autocomplete-icon" />
                    <p:autoComplete id="couleurPateAutocomplete"
                                   value="#{candidatBean.couleurPateAutocompleteSelection}"
                                   completeMethod="#{openThesoDialogBean.completeCouleurPate}"
                                   converter="pactolsConceptConverter"
                                   var="concept"
                                   itemLabel="#{concept.selectedTerm}"
                                   itemValue="#{concept}"
                                   dropdown="false"
                                   minQueryLength="2"
                                   appendTo="#couleurPateAutocompleteWrapper"
                                   my="left top"
                                   at="left bottom"
                                   panelStyleClass="periode-autocomplete-panel"
                                   scrollHeight="280"
                                   emptyMessage="#{openThesoDialogBean.getEmptyMessageFor('COULEUR_PATE')}"
                                   placeholder="Ex. Rouge, Brun..."
                                   styleClass="users-input periode-autocomplete-input"
                                   forceSelection="false"
                                   rendered="#{candidatBean.canEditCurrentBrouillon()}"/>
                    <p:inputText value="#{candidatBean.couleurPate != null ? candidatBean.couleurPate.valeur : ''}"
                                 styleClass="users-input"
                                 readonly="true"
                                 placeholder="Aucune couleur sélectionnée"
                                 rendered="#{candidatBean.isCurrentBrouillonReadOnly()}"/>
                </div>
                <div class="periode-action-buttons">
                    <p:commandButton icon="pi pi-check"
                                     styleClass="candidat-btn-save periode-save-btn"
                                     title="Enregistrer la couleur de pâte"
                                     rendered="#{candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.saveCouleurPateFromAutocomplete}"
                                     process="@form"
                                     ajax="true"
                                     update="@form :growl"/>
                    <p:commandButton icon="pi pi-trash"
                                     styleClass="candidat-btn-remove"
                                     title="Supprimer la couleur de pâte"
                                     rendered="#{candidatBean.hasCouleurPate() and candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.prepareConfirmDeleteCouleurPate()}"
                                     process="@this"
                                     update="@none"
                                     oncomplete="PF('confirmDeleteReferenceDialog').show();"/>
                </div>
            </div>
            <p:message for="@previous" display="icon"/>
        </h:panelGroup>

        <!-- Nature de pâte -->
        <h:panelGroup styleClass="users-form-group users-form-group-full candidats-mt-10">
            <div class="periode-header-row">
                <p:outputLabel value="Nature de pâte" />
            </div>
            <div class="periode-field-row periode-autocomplete-row candidat-production-wrapper candidat-production-group">
                <div id="naturePateAutocompleteWrapper" class="input-wrapper periode-input-wrapper candidats-input-wrapper-border periode-autocomplete-wrapper candidat-production-input-wrapper">
                    <i class="pi pi-th-large input-icon periode-autocomplete-icon" />
                    <p:autoComplete id="naturePateAutocomplete"
                                   value="#{candidatBean.naturePateAutocompleteSelection}"
                                   completeMethod="#{openThesoDialogBean.completeNaturePate}"
                                   converter="pactolsConceptConverter"
                                   var="concept"
                                   itemLabel="#{concept.selectedTerm}"
                                   itemValue="#{concept}"
                                   dropdown="false"
                                   minQueryLength="2"
                                   appendTo="#naturePateAutocompleteWrapper"
                                   my="left top"
                                   at="left bottom"
                                   panelStyleClass="periode-autocomplete-panel"
                                   scrollHeight="280"
                                   emptyMessage="#{openThesoDialogBean.getEmptyMessageFor('NATURE_PATE')}"
                                   placeholder="Ex. Fine, Grossière..."
                                   styleClass="users-input periode-autocomplete-input"
                                   forceSelection="false"
                                   rendered="#{candidatBean.canEditCurrentBrouillon()}"/>
                    <p:inputText value="#{candidatBean.naturePate != null ? candidatBean.naturePate.valeur : ''}"
                                 styleClass="users-input"
                                 readonly="true"
                                 placeholder="Aucune nature sélectionnée"
                                 rendered="#{candidatBean.isCurrentBrouillonReadOnly()}"/>
                </div>
                <div class="periode-action-buttons">
                    <p:commandButton icon="pi pi-check"
                                     styleClass="candidat-btn-save periode-save-btn"
                                     title="Enregistrer la nature de pâte"
                                     rendered="#{candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.saveNaturePateFromAutocomplete}"
                                     process="@form"
                                     ajax="true"
                                     update="@form :growl"/>
                    <p:commandButton icon="pi pi-trash"
                                     styleClass="candidat-btn-remove"
                                     title="Supprimer la nature de pâte"
                                     rendered="#{candidatBean.hasNaturePate() and candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.prepareConfirmDeleteNaturePate()}"
                                     process="@this"
                                     update="@none"
                                     oncomplete="PF('confirmDeleteReferenceDialog').show();"/>
                </div>
            </div>
            <p:message for="@previous" display="icon"/>
        </h:panelGroup>

        <!-- Inclusions -->
        <h:panelGroup styleClass="users-form-group users-form-group-full candidats-mt-10">
            <div class="periode-header-row">
                <p:outputLabel value="Inclusions" />
            </div>
            <div class="periode-field-row periode-autocomplete-row candidat-production-wrapper candidat-production-group">
                <div id="inclusionsAutocompleteWrapper" class="input-wrapper periode-input-wrapper candidats-input-wrapper-border periode-autocomplete-wrapper candidat-production-input-wrapper">
                    <i class="pi pi-circle input-icon periode-autocomplete-icon" />
                    <p:autoComplete id="inclusionsAutocomplete"
                                   value="#{candidatBean.inclusionsAutocompleteSelection}"
                                   completeMethod="#{openThesoDialogBean.completeInclusions}"
                                   converter="pactolsConceptConverter"
                                   var="concept"
                                   itemLabel="#{concept.selectedTerm}"
                                   itemValue="#{concept}"
                                   dropdown="false"
                                   minQueryLength="2"
                                   appendTo="#inclusionsAutocompleteWrapper"
                                   my="left top"
                                   at="left bottom"
                                   panelStyleClass="periode-autocomplete-panel"
                                   scrollHeight="280"
                                   emptyMessage="#{openThesoDialogBean.getEmptyMessageFor('INCLUSIONS')}"
                                   placeholder="Ex. Mica, Calcite..."
                                   styleClass="users-input periode-autocomplete-input"
                                   forceSelection="false"
                                   rendered="#{candidatBean.canEditCurrentBrouillon()}"/>
                    <p:inputText value="#{candidatBean.inclusions != null ? candidatBean.inclusions.valeur : ''}"
                                 styleClass="users-input"
                                 readonly="true"
                                 placeholder="Aucune inclusion sélectionnée"
                                 rendered="#{candidatBean.isCurrentBrouillonReadOnly()}"/>
                </div>
                <div class="periode-action-buttons">
                    <p:commandButton icon="pi pi-check"
                                     styleClass="candidat-btn-save periode-save-btn"
                                     title="Enregistrer les inclusions"
                                     rendered="#{candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.saveInclusionsFromAutocomplete}"
                                     process="@form"
                                     ajax="true"
                                     update="@form :growl"/>
                    <p:commandButton icon="pi pi-trash"
                                     styleClass="candidat-btn-remove"
                                     title="Supprimer les inclusions"
                                     rendered="#{candidatBean.hasInclusions() and candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.prepareConfirmDeleteInclusions()}"
                                     process="@this"
                                     update="@none"
                                     oncomplete="PF('confirmDeleteReferenceDialog').show();"/>
                </div>
            </div>
            <p:message for="@previous" display="icon"/>
        </h:panelGroup>

        <!-- Cuisson/post-cuisson -->
        <h:panelGroup styleClass="users-form-group users-form-group-full candidats-mt-10">
            <div class="periode-header-row">
                <p:outputLabel value="Cuisson/post-cuisson" />
            </div>
            <div class="periode-field-row periode-autocomplete-row candidat-production-wrapper candidat-production-group">
                <div id="cuissonPostCuissonAutocompleteWrapper" class="input-wrapper periode-input-wrapper candidats-input-wrapper-border periode-autocomplete-wrapper candidat-production-input-wrapper">
                    <i class="pi pi-credit-card input-icon periode-autocomplete-icon" />
                    <p:autoComplete id="cuissonPostCuissonAutocomplete"
                                   value="#{candidatBean.cuissonPostCuissonAutocompleteSelection}"
                                   completeMethod="#{openThesoDialogBean.completeCuissonPostCuisson}"
                                   converter="pactolsConceptConverter"
                                   var="concept"
                                   itemLabel="#{concept.selectedTerm}"
                                   itemValue="#{concept}"
                                   dropdown="false"
                                   minQueryLength="2"
                                   appendTo="#cuissonPostCuissonAutocompleteWrapper"
                                   my="left top"
                                   at="left bottom"
                                   panelStyleClass="periode-autocomplete-panel"
                                   scrollHeight="280"
                                   emptyMessage="#{openThesoDialogBean.getEmptyMessageFor('CUISSON_POST_CUISSON')}"
                                   placeholder="Ex. Oxydante, Réductrice..."
                                   styleClass="users-input periode-autocomplete-input"
                                   forceSelection="false"
                                   rendered="#{candidatBean.canEditCurrentBrouillon()}"/>
                    <p:inputText value="#{candidatBean.cuissonPostCuisson != null ? candidatBean.cuissonPostCuisson.valeur : ''}"
                                 styleClass="users-input"
                                 readonly="true"
                                 placeholder="Aucune cuisson/post-cuisson sélectionnée"
                                 rendered="#{candidatBean.isCurrentBrouillonReadOnly()}"/>
                </div>
                <div class="periode-action-buttons">
                    <p:commandButton icon="pi pi-check"
                                     styleClass="candidat-btn-save periode-save-btn"
                                     title="Enregistrer la cuisson/post-cuisson"
                                     rendered="#{candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.saveCuissonPostCuissonFromAutocomplete}"
                                     process="@form"
                                     ajax="true"
                                     update="@form :growl"/>
                    <p:commandButton icon="pi pi-trash"
                                     styleClass="candidat-btn-remove"
                                     title="Supprimer la cuisson/post-cuisson"
                                     rendered="#{candidatBean.hasCuissonPostCuisson() and candidatBean.canEditCurrentBrouillon()}"
                                     actionListener="#{candidatBean.prepareConfirmDeleteCuissonPostCuisson()}"
                                     process="@this"
                                     update="@none"
                                     oncomplete="PF('confirmDeleteReferenceDialog').show();"/>
                </div>
            </div>
            <p:message for="@previous" display="icon"/>
        </h:panelGroup>
    </div>
</ui:composition>

