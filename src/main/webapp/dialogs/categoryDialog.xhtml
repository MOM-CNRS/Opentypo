<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:p="http://primefaces.org/ui"
             xmlns:h="http://xmlns.jcp.org/jsf/html"
             xmlns:f="http://xmlns.jcp.org/jsf/core">

    <!-- Dialog pour créer une nouvelle catégorie -->
    <p:dialog id="createCategoryDialog"
              widgetVar="createCategoryDialog"
              header="Créer une nouvelle catégorie"
              modal="true"
              draggable="false"
              resizable="false"
              styleClass="category-dialog"
              width="600"
              height="auto"
              closable="true">

        <h:form id="categoryForm">
            <f:event listener="#{categoryBean.resetCategoryForm}" type="preRenderView"/>
            <div class="category-form-content">
                <div class="category-form-group">
                    <p:outputLabel for="categoryCode" value="Code de la catégorie *" />
                    <p:inputText id="categoryCode"
                                 value="#{categoryBean.categoryCode}"
                                 required="true"
                                 requiredMessage="Le code de la catégorie est requis"
                                 styleClass="category-input"
                                 placeholder="Ex: CAT001"/>
                </div>

                <div class="category-form-group">
                    <p:outputLabel for="categoryLabel" value="Label *" />
                    <p:inputText id="categoryLabel"
                                 value="#{categoryBean.categoryLabel}"
                                 required="true"
                                 requiredMessage="Le label est requis"
                                 styleClass="category-input"
                                 placeholder="Nom de la catégorie"/>
                </div>

                <div class="category-form-group">
                    <p:outputLabel for="categoryDescription" value="Description" />
                    <p:inputTextarea id="categoryDescription"
                                     value="#{categoryBean.categoryDescription}"
                                     rows="4"
                                     styleClass="category-textarea"
                                     placeholder="Description de la catégorie"/>
                </div>
            </div>

            <div class="category-form-actions">
                <p:commandButton value="Annuler"
                                 icon="pi pi-times"
                                 styleClass="category-btn category-btn-cancel"
                                 onclick="PF('createCategoryDialog').hide(); return false;"
                                 process="@this"
                                 update="@none"/>

                <p:commandButton value="Valider"
                                 icon="pi pi-check"
                                 styleClass="category-btn category-btn-validate"
                                 action="#{applicationBean.createCategory}"
                                 process="@form"
                                 update="@form :growl :categoriesContainer :leftTreePanel"
                                 onstart="var btn = this; showButtonLoading(btn);"
                                 oncomplete="var btn = this; setTimeout(function(){hideButtonLoading(btn); forceHideLoading(); if(!args.validationFailed) {PF('createCategoryDialog').hide();}}, 100);"
                                 onerror="var btn = this; hideButtonLoading(btn); forceHideLoading();"/>
            </div>
        </h:form>
    </p:dialog>

    <h:outputStylesheet library="css" name="categoryDialog.css"/>
</ui:fragment>
